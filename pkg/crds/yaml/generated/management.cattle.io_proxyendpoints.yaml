---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.17.1
  name: proxyendpoints.management.cattle.io
spec:
  group: management.cattle.io
  names:
    kind: ProxyEndpoint
    listKind: ProxyEndpointList
    plural: proxyendpoints
    singular: proxyendpoint
  scope: Cluster
  versions:
  - name: v3
    schema:
      openAPIV3Schema:
        description: |-
          ProxyEndpoint defines a set of domains to be added to the Rancher meta proxy allowlist,
          which determines what external domains the proxy is permitted to forward requests to.
          Domain entries support absolute domain names (e.g., example.com) and wildcard
          patterns using * (prefix matching) or % (single-segment placeholder).
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            properties:
              routes:
                description: |-
                  Routes is a list of domains that will be added to the meta proxy
                  allowlist. These are expected to be domain names, and not URL paths.
                items:
                  properties:
                    domain:
                      description: |-
                        Domain is the domain to be added to the proxy allowlist.
                        Absolute domain names (e.g., example.com) and wildcard patterns are supported.
                        There are two types of supported wildcard patterns:

                        1) Prefix wildcard (*): Matches any subdomain or prefix. Can only appear as the
                           leftmost character of the domain. For example:
                           - *.example.com matches foo.example.com and bar.example.com
                           - *test.com matches footest.com and bartest.com
                           The wildcard character is taken literally; *.*.com is not valid.

                        2) Single-segment placeholder (%): Matches exactly one domain segment.
                           Can be used as the leftmost segment or within the domain as a complete label.
                           For example:
                           - %.example.com matches foo.example.com but not foo.bar.example.com
                           - ec2.%.aws.com matches ec2.us-east-1.aws.com but not ec2.us.east.aws.com
                           The placeholder must be a complete label; %test.com is not valid.

                        Both types of wildcards may be combined (e.g., *.%.example.com).
                        However, overly broad wildcard patterns that match a large number of
                        domains (e.g., "*", "%", "*.*", "*.com", "%.com", "*.co.uk") are not allowed.
                        A webhook validates that patterns include sufficient concrete domain content.

                        Domain entries should not include URL schemes (e.g., "https://").
                        For example, "example.com" is valid, but "https://example.com" is not.
                        It is assumed that all provided domains use HTTPS, and the proxy will route accordingly.
                      maxLength: 253
                      pattern: ^(\*\.?)?([a-zA-Z0-9][-a-zA-Z0-9]{0,61}[a-zA-Z0-9]?|(%\.([a-zA-Z0-9][-a-zA-Z0-9]{0,61}[a-zA-Z0-9]?|%))+)(\.(([a-zA-Z0-9][-a-zA-Z0-9]{0,61}[a-zA-Z0-9]?)|%))*\.[a-zA-Z][-a-zA-Z0-9]{0,61}[a-zA-Z0-9]$
                      type: string
                  required:
                  - domain
                  type: object
                type: array
            required:
            - routes
            type: object
          status:
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
